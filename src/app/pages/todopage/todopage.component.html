<div
  class="App"
  [ngClass]="{ 'high-contrast': themeService.isHighContrastMode }"
>
  <div class="sidebar">
    <app-sidebar (getAllTaskEvent)="getAllTask()"></app-sidebar>
  </div>

  <div class="mainContent">
    <mat-accordion class="accordion__form-filtro">
      <mat-expansion-panel
        (opened)="panelOpenState = true"
        (closed)="panelOpenState = false"
        [ngClass]="{
          'high-contrast border-contrast': themeService.isHighContrastMode
        }"
      >
        <mat-expansion-panel-header
          [ngClass]="{ 'border-contrast': themeService.isHighContrastMode }"
        >
          <mat-panel-title
            [ngClass]="{ 'text-contrast': themeService.isHighContrastMode }"
          >
            Filtro
          </mat-panel-title>
          <mat-panel-description
            [ngClass]="{ 'text-contrast': themeService.isHighContrastMode }"
          >
            Click aqui para {{ panelOpenState ? "fechar" : "abrir" }}
          </mat-panel-description>
        </mat-expansion-panel-header>

        <div
          class="filter"
          [ngClass]="{ 'high-contrast': themeService.isHighContrastMode }"
        >
          <form [formGroup]="taskFilterForm">
            <div class="filter__container">
              <div>
                <label for="numberInput">Número</label>
                <input
                  type="number"
                  formControlName="number"
                  placeholder="Ex.: 3"
                  id="numberInput"
                  [ngClass]="{
                    'input-contrast': themeService.isHighContrastMode
                  }"
                />
              </div>

              <div>
                <label for="situacaoInput">Situação</label>
                <select
                  placeholder="Ex.: Em andamento"
                  id="situacaoInput"
                  formControlName="situation"
                  [ngClass]="{
                    'input-contrast': themeService.isHighContrastMode
                  }"
                >
                  <option disabled selected value="">Ex.: Em andamento</option>
                  <option value="true">Em andamento</option>
                  <option value="false">Concluído</option>
                </select>
              </div>

              <div>
                <label for="titleOrDescription">Título/Descrição</label>
                <input
                  type="text"
                  formControlName="titleOrDescription"
                  id="titleOrDescription"
                  placeholder="Ex.: Comer pastel"
                  [ngClass]="{
                    'input-contrast': themeService.isHighContrastMode
                  }"
                />
              </div>

              <div>
                <label for="responsavel">Responsável</label>
                <select
                  placeholder="Ex.: Luiz"
                  formControlName="responsible"
                  id="responsavel"
                  [ngClass]="{
                    'input-contrast': themeService.isHighContrastMode
                  }"
                >
                  <option disabled selected value="">Ex.: Luiz</option>
                  <option value="Luiz">Luiz</option>
                  <option value="Raí">Raí</option>
                  <option value="Alisson">Alisson</option>
                  <option value="Carlos">Carlos</option>
                  <option value="Laura">Laura</option>
                  <option value="Gabriel">Gabriel</option>
                  <option value="Mariana">Mariana</option>
                  <option value="Daniel">Daniel</option>
                  <option value="Luiza">Luiza</option>
                  <option value="Julia">julia</option>
                </select>
              </div>

              <div class="container__button-filter">
                <button
                  mat-raised-button
                  (click)="cleanFilter()"
                  class="dialog-actions__button_sair"
                  aria-label="Botão para limpar o filtro"
                  [ngClass]="{
                    'button-contrast': themeService.isHighContrastMode
                  }"
                >
                  Limpar filtro
                </button>

                <button
                  mat-raised-button
                  (click)="researchFiltertask()"
                  class="dialog-actions__button_add"
                  aria-label="Botão para buscar tarefa"
                  [ngClass]="{
                    'button-contrast': themeService.isHighContrastMode
                  }"
                >
                  Buscar tarefa
                </button>
              </div>
            </div>
          </form>
        </div>
      </mat-expansion-panel>
    </mat-accordion>

    <div class="table">
      <div>
        <div class="mat-elevation-z8">
          <table
            mat-table
            [dataSource]="dataSource"
            matSort
            [ngClass]="{ 'high-contrast': themeService.isHighContrastMode }"
          >
            <ng-container matColumnDef="id" class="rep_invisible">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header
                class="rep_invisible"
                [ngClass]="{
                  'text-contrast border-contrast':
                    themeService.isHighContrastMode
                }"
              >
                Número
              </th>
              <td
                mat-cell
                *matCellDef="let row"
                class="rep_invisible"
                [ngClass]="{
                  'text-contrast border-contrast':
                    themeService.isHighContrastMode
                }"
              >
                {{ row.id }}
              </td>
            </ng-container>

            <ng-container matColumnDef="title">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header
                [ngClass]="{
                  'text-contrast border-contrast':
                    themeService.isHighContrastMode
                }"
              >
                Título
              </th>
              <td
                mat-cell
                *matCellDef="let row"
                [ngClass]="{
                  'text-contrast border-contrast':
                    themeService.isHighContrastMode
                }"
              >
                {{ row.title }}
              </td>
            </ng-container>

            <ng-container matColumnDef="responsible">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header
                [ngClass]="{
                  'text-contrast border-contrast':
                    themeService.isHighContrastMode
                }"
              >
                Responsável
              </th>
              <td
                mat-cell
                *matCellDef="let row"
                [ngClass]="{
                  'text-contrast border-contrast':
                    themeService.isHighContrastMode
                }"
              >
                {{ row.responsible }}
              </td>
            </ng-container>

            <ng-container matColumnDef="priority" class="rep_invisible">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header
                class="rep_invisible"
                [ngClass]="{
                  'text-contrast border-contrast':
                    themeService.isHighContrastMode
                }"
              >
                Prioridade
              </th>
              <td
                mat-cell
                *matCellDef="let row"
                class="rep_invisible"
                [ngClass]="{
                  'text-contrast border-contrast':
                    themeService.isHighContrastMode
                }"
              >
                {{ row.priority }}
              </td>
            </ng-container>

            <ng-container matColumnDef="deadline" class="rep_invisible">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header
                class="rep_invisible"
                [ngClass]="{
                  'text-contrast border-contrast':
                    themeService.isHighContrastMode
                }"
              >
                Deadline
              </th>
              <td
                mat-cell
                *matCellDef="let row"
                class="rep_invisible"
                [ngClass]="{
                  'text-contrast border-contrast':
                    themeService.isHighContrastMode
                }"
              >
                {{ row.deadline | date }}
              </td>
            </ng-container>

            <ng-container matColumnDef="action">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header
                [ngClass]="{
                  'text-contrast border-contrast':
                    themeService.isHighContrastMode
                }"
              >
                Action
              </th>
              <td
                mat-cell
                *matCellDef="let row"
                [ngClass]="{
                  'border-contrast': themeService.isHighContrastMode
                }"
              >
                <ng-container *ngIf="row.situation; else completed">
                  <button
                    mat-icon-button
                    class="button__edit"
                    (click)="editTask(row)"
                    aria-label="Botão para editar uma tarefa"
                  >
                    <mat-icon
                      [ngClass]="{
                        'text-contrast': themeService.isHighContrastMode
                      }"
                      >edit</mat-icon
                    >
                  </button>
                  <button
                    mat-icon-button
                    class="button__delete"
                    (click)="deleteTask(row.id)"
                    aria-label="Botão para deletar uma tarefa"
                  >
                    <mat-icon
                      [ngClass]="{
                        'text-contrast': themeService.isHighContrastMode
                      }"
                      >delete</mat-icon
                    >
                  </button>
                  <button
                    mat-icon-button
                    class="conclude"
                    (click)="completeTask(row)"
                    aria-label="Botão para concluir uma tarefa"
                  >
                    <mat-icon
                      [ngClass]="{
                        'text-contrast': themeService.isHighContrastMode
                      }"
                      >done</mat-icon
                    >
                  </button>
                </ng-container>

                <ng-template #completed id="conclude"
                  ><p
                    [ngClass]="{
                      'tarefa-contrast': themeService.isHighContrastMode
                    }"
                  >
                    Tarefa Concluída
                  </p></ng-template
                >
              </td>
            </ng-container>
            <ng-container matColumnDef="detalhes">
              <th
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header
                [ngClass]="{
                  'text-contrast, border-contrast ':
                    themeService.isHighContrastMode
                }"
              >
                Detalhes
              </th>
              <td
                mat-cell
                *matCellDef="let row"
                [ngClass]="{
                  'text-contrast, border-contrast ':
                    themeService.isHighContrastMode
                }"
              >
                <button
                  (click)="showDetails(row)"
                  class="showdetails"
                  aria-label="Botão para detalhar uma tarefa"
                >
                  <mat-icon
                    [ngClass]="{
                      'text-contrast': themeService.isHighContrastMode
                    }"
                    >remove_red_eye</mat-icon
                  >
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
          </table>
        </div>
      </div>
    </div>
  </div>
  <div class="footer">
    <app-footer></app-footer>
  </div>
</div>
